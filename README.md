# EE10140-C-Lab2
Code for the stopwatch

/* Main.c file generated by New Project wizard
 *
 * Created:   Fri Apr 9 2021
 * Processor: PIC16F84A
 * Compiler:  MPLAB XC8
 */
 
// Setup configuration bits
#pragma config FOSC = XT 			// XT oscillator
#pragma config WDTE = OFF	 		// WDT disabled
#pragma config PWRTE = ON 			// Power-up Timer enabled
#pragma config CP = OFF 				// No Code protection
 
#define _XTAL_FREQ 4000000			// Oscillator Frequency (4 MHz)

#include <xc.h>

unsigned char numbers[] = {0x80, 0xF2, 0x48, 0x60, 0x32, 0x24, 0x04, 0xF0, 0x00, 0x20};
int interruptFlag;
int i;

void interrupt isr() {
   INTCONbits.INTF = 0;				// Reset the external interrupt
   
   interruptFlag = 1;					// Let the main programm know that the interrupt has occurred
}

void STOP() { 
   interruptFlag = 0;
   
   while (1) {
      PORTB = PORTB;				// Display the current number
      
      if (interruptFlag == 1) {
	 break; 
      }	else if (PORTAbits.RA0 == 1) {
	 i = 0;
	 break;
      }
   }
   interruptFlag = 0;
   return;
}

void main(void) {
   TRISA0 = 0x01;					// Define PORTA0 as input
   TRISB = 0x00;					// Define PORTB as all output pins
   TRISB0 = 0x01;
    
   INTCONbits.INTF = 0;				// Reset the external interrupt
   OPTION_REGbits.INTEDG = 1;		// Interrupt on rising edge
   INTCONbits.INTE = 1;				// Enable the external interrupt
   INTCONbits.GIE = 1;				// Global interrupt enable

   while (1) {
      for (i = 0; i < 10; i++) {
	 
	 if (interruptFlag == 1) {			// Stop counting if the interrupt has occurred
	    STOP();
	 }
	 PORTB = numbers[i];
	 __delay_ms(1000);				// Delay for 1 second
      }
   } 
   return;							//This will never happen
 }
